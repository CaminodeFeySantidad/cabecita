<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Transmisión de Pantalla</title>
</head>
<body>
<h2>Compartir Pantalla</h2>
<button id="start">Iniciar transmisión</button>
<p>ID de transmisión: <span id="my-id"></span></p>

<video id="preview" autoplay style="width:80%;border:1px solid #444;"></video>

<script src="https://cdn.jsdelivr.net/npm/peerjs@1/dist/peerjs.min.js"></script>
<script>
const peer = new Peer();
const preview = document.getElementById("preview");
let screenStream;

peer.on('open', id => {
  document.getElementById("my-id").textContent = id;
});

document.getElementById("start").onclick = async () => {
  screenStream = await navigator.mediaDevices.getDisplayMedia({ video: true });
  preview.srcObject = screenStream;
};

// ✅ Cuando alguien se conecte, enviar la pantalla
peer.on("call", call => {
  call.answer();
  call.on("stream", () => {});
});
</script>
</body>
</html>
